# ┌──────────────────────────────────────────────────────────────────┐
#   Binding generated by pybind11
# └──────────────────────────────────────────────────────────────────┘
project(${CMAKE_PROJECT_NAME}_pybind11 VERSION ${${CMAKE_PROJECT_NAME}_VERSION} LANGUAGES CXX)
find_package(Python 3 REQUIRED COMPONENTS
        Interpreter  # defines: Python_SITELIB, Python_SITEARCH
        Development  # defines: Python::Python, Python_INCLUDE_DIRS, Python_LIBRARIES
        )


# ┌──────────────────────────────────────────────────────────────────┐
#   Configuration flags
# └──────────────────────────────────────────────────────────────────┘
add_library(${PROJECT_NAME} SHARED pwner.cc)
add_dependencies(${PROJECT_NAME} pwner)
target_include_directories(${PROJECT_NAME}
        PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}
                ${Python_INCLUDE_DIRS}
        )
set_target_properties(${PROJECT_NAME} PROPERTIES
        CXX_STANDARD 20
        VERSION   ${${CMAKE_PROJECT_NAME}_VERSION}
        SOVERSION ${${CMAKE_PROJECT_NAME}_VERSION_MAJOR}
        )
set_target_properties(${PROJECT_NAME} PROPERTIES
        PREFIX ""
        OUTPUT_NAME ${CMAKE_PROJECT_NAME}
        )
target_compile_options(${PROJECT_NAME} PUBLIC
        -O1
        -m64
        )
target_compile_definitions(${PROJECT_NAME} PUBLIC
        -D_PYBIND11=1
        )
target_link_libraries(${PROJECT_NAME} PUBLIC
        Python::Python
        pybind11::pybind11
        pwner
        # boost_iostreams
        )


# ┌──────────────────────────────────────────────────────────────────┐
#   Install
# └──────────────────────────────────────────────────────────────────┘
# Files to install to Python's site-packages directory
install(TARGETS ${PROJECT_NAME} DESTINATION ${Python_SITEARCH}) # FIXME[high]: CMakeLists.txt: or ${Python_SITELIB}?
